


var mmd = {"meta_metadata":{"name":"amazon_product","package":"ecologylab.semantics.generated.library.products","schema_org_itemtype":"http://schema.org/Product","user_agent_name":"firefox","parser":"xpath","extends":"product","redirect_handling":"REDIRECT_USUAL","visibility":"GLOBAL","kids":[{"scalar":{"name":"title","xpath":"//span[@id='btAsinTitle']","style":"metadata_h1","layer":"10","navigates_to":"location","schema_org_itemprop":"name","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"description","xpath":"//div[@class='productDescriptionWrapper']","layer":"9","schema_org_itemprop":"description","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"location","hide":"True","always_show":"True","layer":"8","schema_org_itemprop":"url","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataParsedURLScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"page_structure","comment":"For debugging. Type of the structure recognized by information extraction.","hide":"True","layer":"6","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"query","comment":"The search query","layer":"5","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"collection":{"name":"reviews","xpath":"//div[@class='content']/table/tbody/tr[2]/td[1]/div[position() < last()-1]","layer":"1","package":"ecologylab.semantics.generated.library.products","child_type":"product_review","kids":[{"composite":{"name":"product_review","package":"ecologylab.semantics.generated.library.products","type":"product_review","kids":[{"scalar":{"name":"rating","xpath":"./div[2]/span/span[1]/@title","layer":"20","schema_org_itemprop":"reviewRating","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"content","xpath":".","layer":"10","schema_org_itemprop":"reviewBody","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"collection":{"simpl.id":"10261382","name":"mixins","package":"ecologylab.semantics.metadata","promote_children":"True","polymorphic_scope":"repository_metadata","child_type":"metadata","kids":[{"composite":{"name":"metadata","package":"ecologylab.semantics.metadata","promote_children":"True","type":"metadata","kids":[{"scalar":{"simpl.id":"22597652","name":"meta_metadata_name","comment":"Stores the name of the meta-metadata, and is used on restoring from XML.","tag":"mm_name","hide":"True","ignore_in_term_vector":"True","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"collection":{"simpl.ref":"10261382"}},{"collection":{"simpl.id":"42659827","name":"linked_metadata_list","package":"ecologylab.semantics.metadata","polymorphic_scope":"repository_metadata","child_type":"metadata","kids":[{"composite":{"name":"metadata","package":"ecologylab.semantics.metadata","type":"metadata","kids":[{"scalar":{"simpl.ref":"22597652"}},{"collection":{"simpl.ref":"10261382"}},{"collection":{"simpl.ref":"42659827"}},{"collection":{"simpl.id":"17043416","name":"annotations","comment":"User annotations.","package":"ecologylab.semantics.metadata","promote_children":"True","child_type":"annotation","kids":[{"composite":{"name":"annotation","package":"ecologylab.semantics.metadata","promote_children":"True","type":"annotation","kids":[{"scalar":{"name":"creation_time","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataDateScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"author","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"text","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}}]}}]}}]}}]}},{"collection":{"simpl.ref":"17043416"}}]}}]}},{"collection":{"simpl.ref":"42659827"}},{"scalar":{"simpl.ref":"22597652"}}]}}]}},{"collection":{"simpl.id":"54636159","name":"additional_locations","hide":"True","package":"ecologylab.semantics.metadata.builtins","child_tag":"location","child_scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataParsedURLScalarType","kids":[]}},{"collection":{"simpl.ref":"10261382"}},{"scalar":{"simpl.ref":"22597652"}},{"scalar":{"name":"model","schema_org_itemprop":"model","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"collection":{"name":"clippings","comment":"Clippings that this document contains.","hide":"True","package":"ecologylab.semantics.metadata.builtins","polymorphic_scope":"repository_clippings","child_type":"clipping","kids":[{"composite":{"name":"clipping","package":"ecologylab.semantics.metadata.builtins","type":"clipping","kids":[{"scalar":{"name":"context","layer":"10","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"context_html","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"xpath","hide":"True","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"composite":{"name":"source_doc","label":"source","package":"ecologylab.semantics.metadata.builtins","polymorphic_scope":"repository_documents","type":"document","wrap":"True","kids":[{"scalar":{"simpl.id":"35287174","name":"title","comment":"The Title of the Document","style":"metadata_h1","layer":"10","navigates_to":"location","schema_org_itemprop":"name","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"simpl.id":"44419000","name":"description","layer":"9","schema_org_itemprop":"description","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"simpl.id":"52697953","name":"location","comment":"The document's actual location.","hide":"True","always_show":"True","layer":"8","schema_org_itemprop":"url","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataParsedURLScalarType","hint":"XmlAttribute"}},{"collection":{"simpl.ref":"54636159"}},{"collection":{"simpl.ref":"42659827"}},{"collection":{"simpl.ref":"17043416"}},{"scalar":{"simpl.ref":"22597652"}},{"collection":{"simpl.ref":"10261382"}}]}},{"composite":{"name":"outlink","package":"ecologylab.semantics.metadata.builtins","polymorphic_scope":"repository_documents","type":"document","wrap":"True","kids":[{"scalar":{"simpl.ref":"35287174"}},{"scalar":{"simpl.ref":"44419000"}},{"scalar":{"simpl.ref":"52697953"}},{"collection":{"simpl.ref":"54636159"}},{"collection":{"simpl.ref":"42659827"}},{"collection":{"simpl.ref":"17043416"}},{"scalar":{"simpl.ref":"22597652"}},{"collection":{"simpl.ref":"10261382"}}]}},{"collection":{"simpl.ref":"42659827"}},{"collection":{"simpl.ref":"17043416"}},{"scalar":{"simpl.ref":"22597652"}},{"collection":{"simpl.ref":"10261382"}}]}}]}},{"scalar":{"name":"reviews_location","xpath":"//span[@ref='dp_top_cm_cr_acr_pop_']/a/@href","hide":"True","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataParsedURLScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"image_url","xpath":"//td[@id='prodImageCell']//img/@src","hide":"True","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataParsedURLScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"price","xpath":"//b[@class='priceLarge']","schema_org_itemprop":"offers","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"overall_rating","xpath":".//span[1]/@title","context_node":"reviews_span","navigates_to":"reviews_location","schema_org_itemprop":"aggregateRating","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"collection":{"simpl.ref":"42659827"}},{"composite":{"name":"department","xpath":"//table[@id='navCatSubnav']//a[@class='navCatA']","package":"ecologylab.semantics.generated.library.products","type":"document","kids":[{"scalar":{"name":"title","xpath":".","style":"metadata_h1","layer":"10","navigates_to":"location","schema_org_itemprop":"name","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"simpl.ref":"44419000"}},{"scalar":{"name":"location","xpath":"./@href","hide":"True","always_show":"True","layer":"8","schema_org_itemprop":"url","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataParsedURLScalarType","hint":"XmlAttribute"}},{"collection":{"simpl.ref":"54636159"}},{"collection":{"simpl.ref":"42659827"}},{"scalar":{"simpl.ref":"22597652"}},{"collection":{"simpl.ref":"10261382"}}]}},{"composite":{"name":"bestseller_list","tag":"bestseller_list","xpath":"//li[@id='SalesRank']","package":"ecologylab.semantics.generated.library.products","type":"bestseller_list","kids":[{"scalar":{"name":"title","xpath":".//b/a","style":"metadata_h1","layer":"10","navigates_to":"location","schema_org_itemprop":"name","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"simpl.ref":"44419000"}},{"scalar":{"name":"location","xpath":"//li[@id='SalesRank']/a/@href","hide":"True","always_show":"True","layer":"8","schema_org_itemprop":"url","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataParsedURLScalarType","hint":"XmlAttribute"}},{"scalar":{"name":"rank","xpath":"./ul/li/span[@class='zg_hrsr_rank']","scalar_type":"ecologylab.semantics.metadata.scalar.types.MetadataStringScalarType","hint":"XmlAttribute"}},{"scalar":{"simpl.ref":"22597652"}},{"collection":{"simpl.ref":"10261382"}},{"collection":{"simpl.ref":"54636159"}},{"collection":{"simpl.ref":"42659827"}}]}}],"def_var":[{"name":"reviews_span","xpath":"//span[@ref='dp_top_cm_cr_acr_pop_']","type":"node"}],"selector":[{"url_regex":"http://www.amazon.com/[^/]*/dp/[^/]*","domain":"amazon.com"},{"url_regex":"http://www.amazon.com/gp/product/[^/]*","domain":"amazon.com"}],"semantic_actions":[{"if":{"checks":[{"not_null":{"value":"amazon_item"}}]}}]}};

function getDocumentMMD(url) {
	console.log("getting document from url: "+url);
	return mmd;
	
	var result = null;
    if (url != null) {
		//String noAnchorNoQueryPageString = uri.GetLeftPart(UriPartial.Path);
        //result = documentRepositoryByUrlStripped.TryGetValue(noAnchorNoQueryPageString);

		if (result == null) {
			var domain = uri.Domain;
            if (domain != null) {
            	var entries = [];
                //_documentRepositoryByPattern.TryGetValue(domain, out entries);

                if (entries != null) {
                	for (var entry in entries) {
                    	var matcher = entry.Pattern.Match(uri.ToString());
                        if (matcher.Success) {
                        	result = entry.MetaMetadata;
                            break;
                        }
                    }
                }
            }
		}

		if (result == null) {
       		var suffix = uri.Suffix;

           	if (suffix != null)
            	result = GetMMBySuffix(suffix);
        }
        if (result == null)
      	{
        	var domain = uri.Domain;
        	//_documentRepositoryByDomain.TryGetValue(domain, out result);

        	if (result != null)
            	Console.WriteLine("Matched by domain = " + domain + "\t" + result);
    	}

    	if (result == null)
        	result = GetMMByName(tagName);
	}
    return result;		
}